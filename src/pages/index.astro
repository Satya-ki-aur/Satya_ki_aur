---
// import Welcome from '../components/Welcome.astro'; // Commenting out or deleting this line
import Layout from '../layouts/Layout.astro';
import { supabase } from '../lib/supabaseClient.js';

// Fetch videos from Supabase
let videos = [];
const { data, error } = await supabase
	.from('Satya_ki_aur')
	.select('title, youtube_id');

if (error) {
	console.error('Error fetching videos:', error.message);
} else {
	videos = data;
}

// Welcome to Astro! Wondering what to do next? Check out the Astro documentation at https://docs.astro.build
// Don't want to use any of this? Delete everything in this file, the `assets`, `components`, and `layouts` directories, and start fresh.
---

<Layout title="Satya ki aur सत्य की ओर">
	{/* <Welcome /> */ /* Commenting out or deleting this line */}

	<main class="container mx-auto pt-8 md:pt-12 p-4 md:px-8">
		<h1 class="text-3xl font-bold text-center mb-8">सत्य की ओर</h1>
		{videos.length > 0 ? (
			<ul class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
				{videos.map((video) => (
					<li key={video.youtube_id} class="list-none bg-gray-800 rounded-lg shadow-lg overflow-hidden transition-transform duration-200 ease-in-out hover:scale-105">
						<div class="aspect-w-16 aspect-h-9">
							<iframe 
								class="w-full h-full"
								src={`https://www.youtube.com/embed/${video.youtube_id}`}
								title="YouTube video player" 
								frameborder="0" 
								allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" 
								allowfullscreen
							></iframe>
						</div>
						<div class="p-4">
							<h2 class="text-xl font-semibold mb-2">{video.title}</h2>
							{/* We can remove this YouTube ID if it's redundant now */}
							{/* <p class="text-sm text-gray-400">YouTube ID: {video.youtube_id}</p> */}
						</div>
					</li>
				))}
			</ul>
		) : (
			<p>No videos found. Add some to your Supabase table!</p>
		)}
	</main>
</Layout>
